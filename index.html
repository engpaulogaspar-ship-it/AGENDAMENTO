<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5">
    <title>IAT Pro ‚Ä¢ Sistema Corporativo de Reservas</title>
    
    <!-- Fonte e √≠cones -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f8fafd;
            color: #0b1c33;
            line-height: 1.5;
        }

        .app-wrapper {
            display: flex;
            min-height: 100vh;
        }

        /* SIDEBAR */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, #0a1a2f 0%, #0e2a47 100%);
            color: white;
            padding: 2rem 1.5rem;
            box-shadow: 8px 0 20px rgba(0,0,0,0.08);
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.15);
        }

        .sidebar-logo i {
            font-size: 2.2rem;
            color: #3b82f6;
            background: rgba(255,255,255,0.1);
            padding: 12px;
            border-radius: 14px;
        }

        .sidebar-logo span {
            font-size: 1.4rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 18px;
            border-radius: 12px;
            margin-bottom: 6px;
            color: rgba(255,255,255,0.75);
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
        }

        .nav-item i {
            width: 24px;
            text-align: center;
            font-size: 1.2rem;
        }

        .nav-item:hover {
            background: rgba(59, 130, 246, 0.2);
            color: white;
        }

        .nav-item.active {
            background: #3b82f6;
            color: white;
            box-shadow: 0 8px 16px -4px rgba(59, 130, 246, 0.4);
        }

        .user-card {
            margin-top: 40px;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .user-avatar {
            width: 48px;
            height: 48px;
            background: #3b82f6;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            margin-bottom: 12px;
        }

        /* MAIN CONTENT */
        .main-content {
            flex: 1;
            padding: 2rem 2.5rem;
            background: #f8fafd;
            overflow-x: hidden;
        }

        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #0b1c33;
        }

        .page-title i {
            color: #3b82f6;
            margin-right: 12px;
        }

        /* Cards de Estat√≠stica */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 20px;
            box-shadow: 0 8px 20px -6px rgba(0,0,0,0.02);
            border: 1px solid rgba(0,0,0,0.02);
            transition: transform 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 24px -6px rgba(0,0,0,0.04);
        }

        .stat-icon {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #3b82f6;
            font-size: 1.8rem;
            margin-bottom: 16px;
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #0b1c33;
            line-height: 1.2;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #64748b;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Grade de Espa√ßos */
        .espacos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 28px;
            margin-top: 20px;
        }

        .espaco-card {
            background: white;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: 0 12px 30px -8px rgba(0,0,0,0.04);
            transition: all 0.3s;
            border: 1px solid rgba(0,0,0,0.02);
        }

        .espaco-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 24px 40px -8px rgba(59, 130, 246, 0.12);
        }

        .espaco-image {
            height: 200px;
            background-size: cover;
            background-position: center;
            position: relative;
            display: flex;
            align-items: flex-end;
            padding: 20px;
        }

        .espaco-tag {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(4px);
            padding: 8px 16px;
            border-radius: 40px;
            font-weight: 600;
            font-size: 0.85rem;
            color: #0b1c33;
            box-shadow: 0 4px 8px rgba(0,0,0,0.02);
        }

        .espaco-info {
            padding: 24px;
        }

        .espaco-nome {
            font-size: 1.4rem;
            font-weight: 700;
            color: #0b1c33;
            margin-bottom: 8px;
        }

        .espaco-desc {
            color: #475569;
            font-size: 0.95rem;
            margin-bottom: 16px;
            line-height: 1.6;
        }

        .espaco-features {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 16px 0;
        }

        .feature-badge {
            background: #f1f5f9;
            padding: 6px 14px;
            border-radius: 40px;
            font-size: 0.85rem;
            font-weight: 500;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .feature-badge i {
            color: #3b82f6;
        }

        .btn-reserva {
            width: 100%;
            padding: 16px;
            background: linear-gradient(90deg, #2563eb, #3b82f6);
            color: white;
            border: none;
            border-radius: 16px;
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 16px;
        }

        .btn-reserva:hover {
            background: linear-gradient(90deg, #1d4ed8, #2563eb);
            transform: scale(0.98);
        }

        .btn-cancelar {
            padding: 8px 16px;
            background: #fee2e2;
            color: #b91c1c;
            border: none;
            border-radius: 40px;
            font-weight: 600;
            font-size: 0.85rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-cancelar:hover {
            background: #fecaca;
        }

        .btn-aprovar {
            padding: 8px 16px;
            background: #e0f2e6;
            color: #0b6e4f;
            border: none;
            border-radius: 40px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
        }

        .btn-reprovar {
            padding: 8px 16px;
            background: #ffe6e6;
            color: #b91c1c;
            border: none;
            border-radius: 40px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
        }

        /* Tabelas */
        .table-modern {
            background: white;
            border-radius: 20px;
            padding: 4px;
            box-shadow: 0 8px 20px -6px rgba(0,0,0,0.02);
            border: 1px solid rgba(0,0,0,0.02);
            width: 100%;
            border-collapse: collapse;
        }

        .table-modern th {
            padding: 20px 16px;
            text-align: left;
            font-weight: 600;
            color: #475569;
            background: #f8fafc;
            border-bottom: 2px solid #e2e8f0;
        }

        .table-modern td {
            padding: 16px;
            border-bottom: 1px solid #f1f5f9;
        }

        .badge {
            padding: 6px 14px;
            border-radius: 40px;
            font-weight: 600;
            font-size: 0.8rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .badge-pendente {
            background: #fff7e6;
            color: #b45309;
        }

        .badge-aprovado {
            background: #e0f2e6;
            color: #0b6e4f;
        }

        .badge-reprovado {
            background: #ffe6e6;
            color: #b91c1c;
        }

        .badge-cancelado {
            background: #e2e8f0;
            color: #475569;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(6px);
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 32px;
            max-width: 550px;
            width: 90%;
            padding: 32px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.2);
        }

        /* Notifica√ß√£o */
        .notificacao {
            position: fixed;
            top: 30px;
            right: 30px;
            background: white;
            border-left: 6px solid #3b82f6;
            border-radius: 16px;
            padding: 20px 28px;
            box-shadow: 0 20px 35px -8px rgba(0,0,0,0.2);
            z-index: 10000;
            font-family: 'Inter', sans-serif;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Responsividade */
        @media (max-width: 1024px) {
            .app-wrapper { flex-direction: column; }
            .sidebar { width: 100%; height: auto; position: relative; }
        }
    </style>
</head>
<body>
    <div class="app-wrapper">
        <aside class="sidebar" id="sidebar"></aside>
        <main class="main-content" id="mainContent"></main>
    </div>

    <!-- MODAL DE RESERVA -->
    <div id="modalReserva" class="modal">
        <div class="modal-content">
            <h2 style="font-size: 1.8rem; font-weight: 700; margin-bottom: 12px;">
                <i class="fas fa-calendar-plus" style="color: #3b82f6;"></i> Solicitar Reserva
            </h2>
            <p id="modalEspacoNome" style="color: #475569; margin-bottom: 24px; font-size: 1.1rem;"></p>
            
            <div style="margin-bottom: 20px;">
                <label style="font-weight: 600; display: block; margin-bottom: 8px;">Data</label>
                <input type="date" id="reservaData" style="width: 100%; padding: 14px; border-radius: 16px; border: 1px solid #e2e8f0; font-family: 'Inter';" min="">
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">
                <div>
                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">In√≠cio</label>
                    <select id="reservaHoraInicio" style="width: 100%; padding: 14px; border-radius: 16px; border: 1px solid #e2e8f0; font-family: 'Inter';">
                        <option value="">Selecione</option>
                    </select>
                </div>
                <div>
                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">Fim</label>
                    <select id="reservaHoraFim" style="width: 100%; padding: 14px; border-radius: 16px; border: 1px solid #e2e8f0; font-family: 'Inter';">
                        <option value="">Selecione</option>
                    </select>
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="font-weight: 600; display: block; margin-bottom: 8px;">N¬∫ de Pessoas</label>
                <input type="number" id="reservaPessoas" min="1" max="100" value="2" style="width: 100%; padding: 14px; border-radius: 16px; border: 1px solid #e2e8f0; font-family: 'Inter';">
            </div>

            <div style="margin-bottom: 28px;">
                <label style="font-weight: 600; display: block; margin-bottom: 8px;">Finalidade</label>
                <select id="reservaFinalidade" style="width: 100%; padding: 14px; border-radius: 16px; border: 1px solid #e2e8f0; font-family: 'Inter';">
                    <option value="Reuni√£o">Reuni√£o</option>
                    <option value="Treinamento">Treinamento</option>
                    <option value="Apresenta√ß√£o">Apresenta√ß√£o</option>
                    <option value="Workshop">Workshop</option>
                    <option value="Entrevista">Entrevista</option>
                    <option value="Confraterniza√ß√£o">Confraterniza√ß√£o</option>
                    <option value="Futebol">Futebol / Esporte</option>
                </select>
            </div>

            <div style="display: flex; gap: 16px; justify-content: flex-end;">
                <button onclick="fecharModalReserva()" style="padding: 14px 24px; background: #f1f5f9; color: #1e293b; border: none; border-radius: 40px; font-weight: 600; cursor: pointer;">Cancelar</button>
                <button onclick="enviarSolicitacao()" style="padding: 14px 32px; background: #3b82f6; color: white; border: none; border-radius: 40px; font-weight: 600; cursor: pointer;">
                    <i class="fas fa-paper-plane"></i> Solicitar
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL DE CANCELAMENTO (Admin/Usu√°rio) -->
    <div id="modalCancelamento" class="modal">
        <div class="modal-content">
            <h2 style="font-size: 1.8rem; font-weight: 700; margin-bottom: 12px; color: #b91c1c;">
                <i class="fas fa-exclamation-triangle"></i> Cancelar Reserva
            </h2>
            <p id="cancelamentoInfo" style="color: #475569; margin-bottom: 24px;"></p>
            
            <div style="margin-bottom: 20px;">
                <label style="font-weight: 600; display: block; margin-bottom: 8px;">Motivo do cancelamento</label>
                <textarea id="motivoCancelamento" rows="3" style="width: 100%; padding: 14px; border-radius: 16px; border: 1px solid #e2e8f0; font-family: 'Inter';" placeholder="Descreva o motivo..."></textarea>
            </div>

            <div style="display: flex; gap: 16px; justify-content: flex-end;">
                <button onclick="fecharModalCancelamento()" style="padding: 14px 24px; background: #f1f5f9; color: #1e293b; border: none; border-radius: 40px; font-weight: 600; cursor: pointer;">Voltar</button>
                <button onclick="confirmarCancelamento()" style="padding: 14px 32px; background: #b91c1c; color: white; border: none; border-radius: 40px; font-weight: 600; cursor: pointer;">
                    <i class="fas fa-ban"></i> Confirmar Cancelamento
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL DE LINK COMPARTILH√ÅVEL -->
    <div id="modalLink" class="modal">
        <div class="modal-content">
            <h2 style="font-size: 1.8rem; font-weight: 700; margin-bottom: 12px;">
                <i class="fas fa-share-alt" style="color: #10b981;"></i> Link Compartilh√°vel
            </h2>
            <p style="color: #475569; margin-bottom: 24px;">Copie este link e envie para o administrador ou usu√°rio:</p>
            
            <div style="background: #f1f5f9; padding: 16px; border-radius: 16px; word-break: break-all; margin-bottom: 24px; font-size: 0.85rem;" id="linkCompartilhavelTexto">
                Carregando...
            </div>

            <div style="display: flex; gap: 16px; justify-content: flex-end;">
                <button onclick="fecharModalLink()" style="padding: 14px 24px; background: #f1f5f9; color: #1e293b; border: none; border-radius: 40px; font-weight: 600; cursor: pointer;">Fechar</button>
                <button onclick="copiarLink()" style="padding: 14px 32px; background: #3b82f6; color: white; border: none; border-radius: 40px; font-weight: 600; cursor: pointer;">
                    <i class="fas fa-copy"></i> Copiar Link
                </button>
            </div>
        </div>
    </div>

    <script>
        // ============================================================
        // IAT PRO - SISTEMA DE RESERVAS CORPORATIVO
        // ============================================================
        // ‚úÖ AGORA FUNCIONA ENTRE DIFERENTES REDES/COMPUTADORES!
        // ‚úÖ USANDO LINK COMPARTILH√ÅVEL COM TODOS OS DADOS
        // ============================================================

        // ---------- BANCO DE DADOS - 6 ESPA√áOS ----------
        const ESPACOS_PREMIUM = [
            {
                id: 1,
                nome: "‚≠ê CONNECT HUB",
                tipo: "sala",
                capacidade: 16,
                recursos: ["Videoconfer√™ncia 4K", "Som Dolby", "Lousa Interativa", "Wi-Fi 6"],
                descricao: "Sala de reuni√µes inteligente com sistema de som imersivo e tela touch de 86''. Ideal para apresenta√ß√µes de alto impacto.",
                imagem: "https://images.unsplash.com/photo-1573164713714-d95e436ab8d6?w=600",
                icone: "fa-video",
                status: "ativo",
                cor: "#2563eb"
            },
            {
                id: 2,
                nome: "üéØ AUDIT√ìRIO IMPACT",
                tipo: "auditorio",
                capacidade: 80,
                recursos: ["Palco", "Projetor IMAX", "Sistema de Tradu√ß√£o", "Ilumina√ß√£o C√™nica"],
                descricao: "Audit√≥rio com capacidade para 80 pessoas, ideal para palestras, treinamentos e eventos corporativos. Ac√∫stica profissional.",
                imagem: "https://images.unsplash.com/photo-1517457373958-b7bdd4587205?w=600",
                icone: "fa-chalkboard",
                status: "ativo",
                cor: "#8b5cf6"
            },
            {
                id: 3,
                nome: "üß† CREATIVE LAB",
                tipo: "treinamento",
                capacidade: 24,
                recursos: ["Brinstorming Wall", "M√≥veis Modulares", "Realidade Virtual", "Caf√© Especial"],
                descricao: "Espa√ßo colaborativo com design biof√≠lico. Perfeito para sess√µes de criatividade, design thinking e workshops.",
                imagem: "https://images.unsplash.com/photo-1497366216548-37526070297c?w=600",
                icone: "fa-lightbulb",
                status: "ativo",
                cor: "#eab308"
            },
            {
                id: 4,
                nome: "üßò OASIS LOUNGE",
                tipo: "lazer",
                capacidade: 12,
                recursos: ["Poltronas Ergon√¥micas", "Jogos", "Bebidas Gratuitas", "Varanda Gourmet"],
                descricao: "Espa√ßo de descompress√£o com ambiente relaxante. Perfeito para pausas, happy hours ou reuni√µes informais.",
                imagem: "https://images.unsplash.com/photo-1598928506911-5c200b0e7c1c?w=600",
                icone: "fa-couch",
                status: "ativo",
                cor: "#10b981"
            },
            {
                id: 5,
                nome: "üéôÔ∏è STUDIO PODCAST",
                tipo: "especial",
                capacidade: 6,
                recursos: ["Isolamento Ac√∫stico", "Microfones Profissionais", "Mesa de Som", "C√¢meras 4K"],
                descricao: "Est√∫dio pronto para grava√ß√£o de podcasts, v√≠deos e lives. Tratamento ac√∫stico e equipamento de broadcast.",
                imagem: "https://images.unsplash.com/photo-1598488035139-bdbb2231ce04?w=600",
                icone: "fa-microphone",
                status: "ativo",
                cor: "#ec4899"
            },
            {
                id: 6,
                nome: "‚öΩ QUADRA SOCIETY",
                tipo: "esportes",
                capacidade: 20,
                recursos: ["Grama Sint√©tica", "Ilumina√ß√£o LED", "Vesti√°rios", "Arquibancada", "Chuteiras dispon√≠veis"],
                descricao: "Quadra de futebol society oficial com medidas profissionais. Perfeita para confraterniza√ß√µes, campeonatos internos e integra√ß√£o de times.",
                imagem: "https://images.unsplash.com/photo-1575361204480-aadea25e6e68?w=600",
                icone: "fa-futbol",
                status: "ativo",
                cor: "#22c55e"
            }
        ];

        // ---------- ESTADO GLOBAL ----------
        let usuarios = JSON.parse(localStorage.getItem('spaceflow_usuarios')) || [
            { id: 1, nome: "Admin Master", email: "admin@spaceflow.com", senha: "admin123", tipo: "admin", status: "ativo", avatar: "AM" },
            { id: 2, nome: "Usu√°rio Teste", email: "user@teste.com", senha: "123456", tipo: "usuario", status: "ativo", avatar: "UT" }
        ];

        let espacos = JSON.parse(localStorage.getItem('spaceflow_espacos')) || ESPACOS_PREMIUM;
        let solicitacoes = JSON.parse(localStorage.getItem('spaceflow_solicitacoes')) || [];
        let currentUser = JSON.parse(localStorage.getItem('spaceflow_user')) || null;

        // Vari√°veis de controle
        let espacoSelecionadoId = null;
        let solicitacaoParaCancelar = null;
        let linkAtual = '';

        // ---------- FUN√á√ïES DE PERSIST√äNCIA ----------
        function salvarUsuarios() { localStorage.setItem('spaceflow_usuarios', JSON.stringify(usuarios)); }
        function salvarEspacos() { localStorage.setItem('spaceflow_espacos', JSON.stringify(espacos)); }
        function salvarSolicitacoes() { localStorage.setItem('spaceflow_solicitacoes', JSON.stringify(solicitacoes)); }
        function salvarSessao() { localStorage.setItem('spaceflow_user', JSON.stringify(currentUser)); }

        // ---------- FUN√á√ÉO PARA GERAR LINK COMPARTILH√ÅVEL ----------
        function gerarLinkCompartilhavel() {
            const dadosCompletos = {
                usuarios: usuarios,
                espacos: espacos,
                solicitacoes: solicitacoes,
                versao: "1.0"
            };
            
            const dadosString = JSON.stringify(dadosCompletos);
            const dadosBase64 = btoa(encodeURIComponent(dadosString));
            const link = `${window.location.origin}${window.location.pathname}?data=${dadosBase64}`;
            
            linkAtual = link;
            return link;
        }

        // ---------- FUN√á√ÉO PARA CARREGAR DADOS DO LINK ----------
        function carregarDadosDoLink() {
            const urlParams = new URLSearchParams(window.location.search);
            const dadosBase64 = urlParams.get('data');
            
            if (dadosBase64) {
                try {
                    const dadosString = decodeURIComponent(atob(dadosBase64));
                    const dados = JSON.parse(dadosString);
                    
                    if (dados.usuarios) usuarios = dados.usuarios;
                    if (dados.espacos) espacos = dados.espacos;
                    if (dados.solicitacoes) solicitacoes = dados.solicitacoes;
                    
                    // Salvar no localStorage local
                    salvarUsuarios();
                    salvarEspacos();
                    salvarSolicitacoes();
                    
                    // Mostrar notifica√ß√£o de sucesso
                    mostrarNotificacao('üì¶ Dados carregados do link compartilhado!', 'success');
                    
                    // Limpar URL (opcional)
                    // window.history.replaceState({}, document.title, window.location.pathname);
                    
                    return true;
                } catch (e) {
                    console.error('Erro ao carregar dados:', e);
                    mostrarNotificacao('‚ùå Erro ao carregar dados do link', 'error');
                }
            }
            return false;
        }

        // ---------- FUN√á√ÉO PARA MOSTRAR NOTIFICA√á√ÉO ----------
        function mostrarNotificacao(mensagem, tipo = 'info') {
            const notificacao = document.createElement('div');
            notificacao.className = 'notificacao';
            
            const cores = {
                success: '#10b981',
                error: '#ef4444',
                info: '#3b82f6',
                warning: '#f59e0b'
            };
            
            notificacao.style.borderLeftColor = cores[tipo] || cores.info;
            
            notificacao.innerHTML = `
                <div style="display: flex; align-items: center; gap: 14px;">
                    <div style="background: #eef2ff; padding: 12px; border-radius: 14px;">
                        <i class="fas fa-${tipo === 'success' ? 'check-circle' : tipo === 'error' ? 'exclamation-circle' : 'info-circle'}" style="color: ${cores[tipo] || cores.info}; font-size: 1.4rem;"></i>
                    </div>
                    <div>
                        <p style="color: #0b1c33; font-weight: 500;">${mensagem}</p>
                    </div>
                </div>
            `;
            
            document.body.appendChild(notificacao);
            setTimeout(() => notificacao.remove(), 5000);
        }

        // ---------- FUN√á√ÉO PARA ABRIR MODAL DE LINK ----------
        function abrirModalLink() {
            const link = gerarLinkCompartilhavel();
            document.getElementById('linkCompartilhavelTexto').textContent = link;
            document.getElementById('modalLink').classList.add('active');
        }

        window.fecharModalLink = function() {
            document.getElementById('modalLink').classList.remove('active');
        };

        window.copiarLink = function() {
            navigator.clipboard.writeText(linkAtual).then(() => {
                mostrarNotificacao('‚úÖ Link copiado para a √°rea de transfer√™ncia!', 'success');
                fecharModalLink();
            }).catch(() => {
                mostrarNotificacao('‚ùå Erro ao copiar link', 'error');
            });
        };

        // ---------- SIMULA√á√ÉO DE EMAIL ----------
        function enviarEmail(destinatario, assunto, mensagem) {
            console.log(`üìß EMAIL ENVIADO para ${destinatario} | Assunto: ${assunto}`);
            
            // Notifica√ß√£o visual
            const notificacao = document.createElement('div');
            notificacao.className = 'notificacao';
            notificacao.style.borderLeftColor = assunto.includes('‚úÖ') ? '#10b981' : assunto.includes('‚ùå') ? '#ef4444' : '#3b82f6';
            notificacao.innerHTML = `
                <div style="display: flex; align-items: center; gap: 14px;">
                    <div style="background: #eef2ff; padding: 12px; border-radius: 14px;">
                        <i class="fas fa-envelope" style="color: #3b82f6; font-size: 1.4rem;"></i>
                    </div>
                    <div>
                        <strong style="font-size: 1rem;">${assunto}</strong>
                        <p style="color: #475569; margin-top: 4px; font-size: 0.9rem;">Para: ${destinatario}</p>
                    </div>
                </div>
            `;
            document.body.appendChild(notificacao);
            setTimeout(() => notificacao.remove(), 5000);
            return true;
        }

        // ---------- RENDERIZA√á√ÉO DA INTERFACE ----------
        function renderizarInterface() {
            const sidebar = document.getElementById('sidebar');
            const main = document.getElementById('mainContent');

            if (!currentUser) {
                // Tela de Login/Cadastro
                sidebar.style.display = 'none';
                main.innerHTML = `
                    <div style="max-width: 500px; margin: 80px auto;">
                        <div style="background: white; border-radius: 40px; padding: 48px; box-shadow: 0 30px 50px -20px rgba(0,0,0,0.08);">
                            <div style="text-align: center; margin-bottom: 32px;">
                                <div style="background: linear-gradient(135deg, #2563eb, #3b82f6); width: 80px; height: 80px; border-radius: 24px; display: flex; align-items: center; justify-content: center; margin: 0 auto 24px;">
                                    <i class="fas fa-calendar-alt" style="font-size: 2.8rem; color: white;"></i>
                                </div>
                                <h1 style="font-size: 2.2rem; font-weight: 800; color: #0b1c33;">Instituto √Ågua e Terra - IAT</h1>
                                <p style="color: #64748b; margin-top: 12px;">Sistema corporativo de reservas</p>
                                <p style="color: #3b82f6; margin-top: 8px; font-weight: 500;"><i class="fas fa-share-alt"></i> COMPARTILH√ÅVEL entre redes!</p>
                            </div>
                            
                            <div style="display: flex; gap: 16px; margin-bottom: 32px; background: #f1f5f9; padding: 6px; border-radius: 60px;">
                                <button id="tabLoginBtn" class="auth-tab active" style="flex:1; padding: 14px; border-radius: 40px; border: none; background: white; font-weight: 700; color: #0b1c33; box-shadow: 0 4px 10px rgba(0,0,0,0.02); cursor: pointer;">Login</button>
                                <button id="tabCadastroBtn" class="auth-tab" style="flex:1; padding: 14px; border-radius: 40px; border: none; background: transparent; font-weight: 600; color: #64748b; cursor: pointer;">Cadastrar</button>
                            </div>

                            <div id="loginFormContainer">
                                <div style="margin-bottom: 20px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">Email</label>
                                    <input type="email" id="loginEmail" placeholder="seu@email.com" style="width: 100%; padding: 16px; border-radius: 20px; border: 1.5px solid #e2e8f0; font-size: 1rem; font-family: 'Inter';">
                                </div>
                                <div style="margin-bottom: 28px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">Senha</label>
                                    <input type="password" id="loginSenha" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" style="width: 100%; padding: 16px; border-radius: 20px; border: 1.5px solid #e2e8f0; font-size: 1rem; font-family: 'Inter';">
                                </div>
                                <button onclick="fazerLogin()" style="width: 100%; padding: 18px; background: linear-gradient(90deg, #2563eb, #3b82f6); color: white; border: none; border-radius: 40px; font-weight: 700; font-size: 1.1rem; cursor: pointer;">
                                    <i class="fas fa-arrow-right-to-bracket"></i> Entrar
                                </button>
                            </div>

                            <div id="cadastroFormContainer" style="display: none;">
                                <div style="margin-bottom: 16px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">Nome completo</label>
                                    <input type="text" id="regNome" placeholder="Seu nome" style="width: 100%; padding: 16px; border-radius: 20px; border: 1.5px solid #e2e8f0; font-family: 'Inter';">
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">Email</label>
                                    <input type="email" id="regEmail" placeholder="seu@email.com" style="width: 100%; padding: 16px; border-radius: 20px; border: 1.5px solid #e2e8f0; font-family: 'Inter';">
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">Senha</label>
                                    <input type="password" id="regSenha" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" style="width: 100%; padding: 16px; border-radius: 20px; border: 1.5px solid #e2e8f0; font-family: 'Inter';">
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">Confirmar senha</label>
                                    <input type="password" id="regConfirmSenha" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" style="width: 100%; padding: 16px; border-radius: 20px; border: 1.5px solid #e2e8f0; font-family: 'Inter';">
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">Tipo de conta</label>
                                    <select id="regTipo" style="width: 100%; padding: 16px; border-radius: 20px; border: 1.5px solid #e2e8f0; background: white; font-family: 'Inter';">
                                        <option value="usuario">Usu√°rio</option>
                                        <option value="admin">Administrador</option>
                                    </select>
                                </div>
                                <div id="adminCodeGroup" style="display: none; margin-bottom: 24px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">C√≥digo Admin</label>
                                    <input type="password" id="adminCode" placeholder="ADMIN123" style="width: 100%; padding: 16px; border-radius: 20px; border: 1.5px solid #e2e8f0; font-family: 'Inter';">
                                </div>
                                <button onclick="cadastrarUsuario()" style="width: 100%; padding: 18px; background: #0b1c33; color: white; border: none; border-radius: 40px; font-weight: 700; font-size: 1.1rem; cursor: pointer;">
                                    <i class="fas fa-user-plus"></i> Criar conta
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                setTimeout(() => {
                    document.getElementById('tabLoginBtn')?.addEventListener('click', function() {
                        document.querySelectorAll('.auth-tab').forEach(t => {
                            t.style.background = 'transparent';
                            t.style.color = '#64748b';
                            t.style.fontWeight = '600';
                        });
                        this.style.background = 'white';
                        this.style.color = '#0b1c33';
                        this.style.fontWeight = '700';
                        document.getElementById('loginFormContainer').style.display = 'block';
                        document.getElementById('cadastroFormContainer').style.display = 'none';
                    });
                    
                    document.getElementById('tabCadastroBtn')?.addEventListener('click', function() {
                        document.querySelectorAll('.auth-tab').forEach(t => {
                            t.style.background = 'transparent';
                            t.style.color = '#64748b';
                            t.style.fontWeight = '600';
                        });
                        this.style.background = 'white';
                        this.style.color = '#0b1c33';
                        this.style.fontWeight = '700';
                        document.getElementById('loginFormContainer').style.display = 'none';
                        document.getElementById('cadastroFormContainer').style.display = 'block';
                    });
                    
                    document.getElementById('regTipo')?.addEventListener('change', function() {
                        document.getElementById('adminCodeGroup').style.display = this.value === 'admin' ? 'block' : 'none';
                    });
                }, 50);
                return;
            }

            // --- USU√ÅRIO LOGADO ---
            sidebar.style.display = 'block';
            const isAdmin = currentUser.tipo === 'admin';
            
            sidebar.innerHTML = `
                <div class="sidebar-logo">
                    <i class="fas fa-calendar-check"></i>
                    <div>
                        <span>SpaceFlow</span>
                        <small>${isAdmin ? 'Administra√ß√£o' : 'Reservas'}</small>
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    ${isAdmin ? `
                        <div class="nav-item active" data-view="admin-dashboard">
                            <i class="fas fa-chart-pie"></i> Dashboard
                        </div>
                        <div class="nav-item" data-view="admin-solicitacoes">
                            <i class="fas fa-clipboard-list"></i> Solicita√ß√µes
                        </div>
                        <div class="nav-item" data-view="admin-espacos">
                            <i class="fas fa-door-open"></i> Espa√ßos
                        </div>
                        <div class="nav-item" data-view="admin-usuarios">
                            <i class="fas fa-users-cog"></i> Usu√°rios
                        </div>
                        <div class="nav-item" onclick="abrirModalLink()" style="background: #3b82f6; color: white; margin-top: 20px;">
                            <i class="fas fa-share-alt"></i> COMPARTILHAR DADOS
                        </div>
                    ` : `
                        <div class="nav-item active" data-view="user-home">
                            <i class="fas fa-home"></i> In√≠cio
                        </div>
                        <div class="nav-item" data-view="user-reservar">
                            <i class="fas fa-plus-circle"></i> Nova Reserva
                        </div>
                        <div class="nav-item" data-view="user-solicitacoes">
                            <i class="fas fa-clock"></i> Minhas Solicita√ß√µes
                        </div>
                        <div class="nav-item" onclick="abrirModalLink()" style="background: #3b82f6; color: white; margin-top: 20px;">
                            <i class="fas fa-share-alt"></i> COMPARTILHAR DADOS
                        </div>
                    `}
                </div>
                
                <div class="user-card">
                    <div class="user-avatar">${currentUser.avatar || currentUser.nome.charAt(0)}</div>
                    <div style="font-weight: 700; font-size: 1.2rem; margin-bottom: 4px;">${currentUser.nome}</div>
                    <div style="color: #a0c0e0; font-size: 0.9rem; margin-bottom: 16px;">${currentUser.email}</div>
                    <div style="display: flex; gap: 10px;">
                        <span style="background: rgba(59,130,246,0.2); padding: 6px 16px; border-radius: 40px; font-size: 0.8rem; font-weight: 600; color: white;">
                            <i class="fas fa-${isAdmin ? 'crown' : 'user'}"></i> ${isAdmin ? 'Admin' : 'Usu√°rio'}
                        </span>
                    </div>
                    <button onclick="logout()" style="width: 100%; margin-top: 24px; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.1); border-radius: 40px; color: white; font-weight: 600; cursor: pointer;">
                        <i class="fas fa-sign-out-alt"></i> Sair
                    </button>
                </div>
            `;

            setTimeout(() => {
                document.querySelectorAll('.nav-item[data-view]').forEach(item => {
                    item.addEventListener('click', function() {
                        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                        this.classList.add('active');
                        const view = this.dataset.view;
                        if (view) renderizarView(view);
                    });
                });
            }, 50);

            renderizarView(isAdmin ? 'admin-dashboard' : 'user-home');
        }

        // ---------- RENDERIZAR VIEWS ----------
        function renderizarView(view) {
            const main = document.getElementById('mainContent');
            
            if (view === 'user-home') {
                const espacosAtivos = espacos.filter(e => e.status === 'ativo');
                const minhasAprovadas = solicitacoes.filter(s => s.usuarioId === currentUser.id && s.status === 'aprovado').length;
                const minhasPendentes = solicitacoes.filter(s => s.usuarioId === currentUser.id && s.status === 'pendente').length;
                
                main.innerHTML = `
                    <div class="top-bar">
                        <h1 class="page-title"><i class="fas fa-home"></i> Ol√°, ${currentUser.nome.split(' ')[0]}</h1>
                        <div style="display: flex; gap: 12px;">
                            <span style="background: white; padding: 10px 20px; border-radius: 40px; font-weight: 500; box-shadow: 0 4px 10px rgba(0,0,0,0.02);">
                                <i class="fas fa-check-circle" style="color: #10b981;"></i> ${minhasAprovadas} ativas
                            </span>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-door-open"></i></div>
                            <div class="stat-value">${espacosAtivos.length}</div>
                            <div class="stat-label">Espa√ßos dispon√≠veis</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-clock"></i></div>
                            <div class="stat-value">${minhasPendentes}</div>
                            <div class="stat-label">Solicita√ß√µes pendentes</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-check"></i></div>
                            <div class="stat-value">${minhasAprovadas}</div>
                            <div class="stat-label">Reservas aprovadas</div>
                        </div>
                    </div>
                    
                    <h2 style="font-size: 1.6rem; font-weight: 700; margin: 40px 0 24px;">
                        Nossos espa√ßos <span style="color: #3b82f6; font-weight: 400;">(6 ambientes)</span>
                    </h2>
                    
                    <div class="espacos-grid">
                        ${espacosAtivos.map(espaco => `
                            <div class="espaco-card">
                                <div class="espaco-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0.2), rgba(0,0,0,0.6)), url('${espaco.imagem}');">
                                    <span class="espaco-tag">
                                        <i class="fas ${espaco.icone}"></i> At√© ${espaco.capacidade} pessoas
                                    </span>
                                </div>
                                <div class="espaco-info">
                                    <div class="espaco-nome">${espaco.nome}</div>
                                    <div class="espaco-desc">${espaco.descricao}</div>
                                    <div class="espaco-features">
                                        ${espaco.recursos.slice(0, 3).map(r => `
                                            <span class="feature-badge"><i class="fas fa-check-circle"></i> ${r}</span>
                                        `).join('')}
                                        ${espaco.recursos.length > 3 ? `<span class="feature-badge">+${espaco.recursos.length-3}</span>` : ''}
                                    </div>
                                    <button onclick="abrirModalReserva(${espaco.id})" class="btn-reserva">
                                        <i class="fas fa-calendar-plus"></i> Solicitar reserva
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            else if (view === 'user-solicitacoes') {
                const minhas = solicitacoes.filter(s => s.usuarioId === currentUser.id)
                    .sort((a,b) => new Date(b.dataSolicitacao) - new Date(a.dataSolicitacao));
                
                main.innerHTML = `
                    <div class="top-bar">
                        <h1 class="page-title"><i class="fas fa-clock"></i> Minhas solicita√ß√µes</h1>
                        <span style="background: white; padding: 10px 20px; border-radius: 40px; font-weight: 500;">
                            Total: ${minhas.length}
                        </span>
                    </div>
                    
                    ${minhas.length === 0 ? `
                        <div style="background: white; border-radius: 24px; padding: 60px; text-align: center;">
                            <i class="fas fa-calendar-xmark" style="font-size: 4rem; color: #cbd5e1; margin-bottom: 20px;"></i>
                            <h3 style="font-size: 1.4rem; margin-bottom: 12px;">Nenhuma solicita√ß√£o</h3>
                            <p style="color: #64748b; margin-bottom: 24px;">Voc√™ ainda n√£o fez nenhuma reserva.</p>
                            <button onclick="renderizarView('user-reservar')" style="padding: 16px 32px; background: #3b82f6; color: white; border: none; border-radius: 40px; font-weight: 600;">
                                <i class="fas fa-plus"></i> Nova reserva
                            </button>
                        </div>
                    ` : `
                        <div style="background: white; border-radius: 24px; padding: 24px;">
                            ${minhas.map(s => {
                                const espaco = espacos.find(e => e.id === s.espacoId) || { nome: s.espacoNome, icone: 'fa-door-open', cor: '#64748b' };
                                const podeCancelar = s.status === 'aprovado' || s.status === 'pendente';
                                return `
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 20px; border-bottom: 1px solid #f1f5f9;">
                                        <div style="display: flex; gap: 20px; align-items: center;">
                                            <div style="background: ${espaco.cor || '#eef2ff'}15; padding: 12px; border-radius: 16px;">
                                                <i class="fas ${espaco.icone || 'fa-door-open'}" style="color: ${espaco.cor || '#3b82f6'};"></i>
                                            </div>
                                            <div>
                                                <h4 style="font-weight: 700; margin-bottom: 6px;">${espaco.nome || s.espacoNome}</h4>
                                                <div style="display: flex; gap: 20px; color: #475569; font-size: 0.95rem;">
                                                    <span><i class="fas fa-calendar"></i> ${new Date(s.data).toLocaleDateString('pt-BR')}</span>
                                                    <span><i class="fas fa-clock"></i> ${s.horaInicio} - ${s.horaFim}</span>
                                                    <span><i class="fas fa-users"></i> ${s.quantidadePessoas}</span>
                                                </div>
                                                ${s.motivoCancelamento ? `<p style="color: #b91c1c; font-size: 0.85rem; margin-top: 8px;"><i class="fas fa-info-circle"></i> Cancelado: ${s.motivoCancelamento}</p>` : ''}
                                            </div>
                                        </div>
                                        <div style="display: flex; gap: 16px; align-items: center;">
                                            <span class="badge badge-${s.status}">
                                                <i class="fas fa-${s.status === 'aprovado' ? 'check' : s.status === 'pendente' ? 'hourglass' : s.status === 'cancelado' ? 'ban' : 'xmark'}"></i>
                                                ${s.status === 'aprovado' ? 'Aprovado' : s.status === 'pendente' ? 'Pendente' : s.status === 'cancelado' ? 'Cancelado' : 'Reprovado'}
                                            </span>
                                            ${podeCancelar ? `
                                                <button onclick="abrirModalCancelamento(${s.id})" class="btn-cancelar">
                                                    <i class="fas fa-ban"></i> Cancelar
                                                </button>
                                            ` : ''}
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `}
                `;
            }
            
            else if (view === 'admin-dashboard') {
                const totalSolicitacoes = solicitacoes.length;
                const pendentes = solicitacoes.filter(s => s.status === 'pendente').length;
                const aprovadas = solicitacoes.filter(s => s.status === 'aprovado').length;
                const canceladas = solicitacoes.filter(s => s.status === 'cancelado').length;
                const totalUsuarios = usuarios.length;
                
                main.innerHTML = `
                    <div class="top-bar">
                        <h1 class="page-title"><i class="fas fa-chart-pie"></i> Dashboard</h1>
                        <span style="background: #eef2ff; padding: 10px 22px; border-radius: 40px; color: #2563eb; font-weight: 600;">
                            <i class="fas fa-shield-alt"></i> Admin
                        </span>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-file-signature"></i></div>
                            <div class="stat-value">${totalSolicitacoes}</div>
                            <div class="stat-label">Total solicita√ß√µes</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-hourglass-half"></i></div>
                            <div class="stat-value">${pendentes}</div>
                            <div class="stat-label">Pendentes</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                            <div class="stat-value">${aprovadas}</div>
                            <div class="stat-label">Aprovadas</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-ban"></i></div>
                            <div class="stat-value">${canceladas}</div>
                            <div class="stat-label">Canceladas</div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 28px; margin-top: 32px;">
                        <div style="background: white; border-radius: 24px; padding: 24px;">
                            <h3 style="font-weight: 700; margin-bottom: 20px;"><i class="fas fa-clock" style="color: #f59e0b;"></i> Solicita√ß√µes pendentes</h3>
                            ${solicitacoes.filter(s => s.status === 'pendente').slice(0, 5).map(s => {
                                const user = usuarios.find(u => u.id === s.usuarioId);
                                return `
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                        <div>
                                            <strong>${s.espacoNome}</strong>
                                            <p style="font-size: 0.85rem; color: #64748b;">${user?.nome || 'Usu√°rio'} ‚Ä¢ ${new Date(s.data).toLocaleDateString('pt-BR')}</p>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button onclick="aprovarSolicitacao(${s.id})" class="btn-aprovar">
                                                <i class="fas fa-check"></i>
                                            </button>
                                            <button onclick="reprovarSolicitacao(${s.id})" class="btn-reprovar">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                    </div>
                                `;
                            }).join('') || '<p style="color: #64748b;">Nenhuma solicita√ß√£o pendente</p>'}
                        </div>
                        
                        <div style="background: white; border-radius: 24px; padding: 24px;">
                            <h3 style="font-weight: 700; margin-bottom: 20px;"><i class="fas fa-trophy"></i> Espa√ßos mais usados</h3>
                            ${(() => {
                                const ranking = {};
                                solicitacoes.filter(s => s.status === 'aprovado').forEach(s => {
                                    ranking[s.espacoNome] = (ranking[s.espacoNome] || 0) + 1;
                                });
                                const top = Object.entries(ranking).sort((a,b) => b[1] - a[1]).slice(0, 5);
                                return top.map(([nome, count]) => `
                                    <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                        <span><i class="fas fa-door-open" style="color: #3b82f6;"></i> ${nome}</span>
                                        <span style="background: #eef2ff; padding: 4px 12px; border-radius: 40px; font-weight: 600;">${count} reservas</span>
                                    </div>
                                `).join('') || '<p style="color: #64748b;">Nenhuma reserva aprovada</p>';
                            })()}
                        </div>
                    </div>
                `;
            }
            
            else if (view === 'admin-solicitacoes') {
                main.innerHTML = `
                    <div class="top-bar">
                        <h1 class="page-title"><i class="fas fa-clipboard-list"></i> Solicita√ß√µes</h1>
                        <div style="display: flex; gap: 12px;">
                            <span style="background: white; padding: 10px 20px; border-radius: 40px; font-weight: 500;">
                                Total: ${solicitacoes.length}
                            </span>
                        </div>
                    </div>
                    
                    <div style="background: white; border-radius: 24px; padding: 24px; overflow-x: auto;">
                        <table class="table-modern">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Solicitante</th>
                                    <th>Espa√ßo</th>
                                    <th>Data</th>
                                    <th>Hor√°rio</th>
                                    <th>Pessoas</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${solicitacoes.sort((a,b) => new Date(b.dataSolicitacao) - new Date(a.dataSolicitacao)).map(s => {
                                    const user = usuarios.find(u => u.id === s.usuarioId);
                                    return `
                                        <tr>
                                            <td>#${s.id}</td>
                                            <td>
                                                <strong>${user?.nome || 'Desconhecido'}</strong>
                                                <br><span style="font-size: 0.8rem; color: #64748b;">${user?.email || ''}</span>
                                            </td>
                                            <td><i class="fas fa-door-open" style="color: #3b82f6;"></i> ${s.espacoNome}</td>
                                            <td>${new Date(s.data).toLocaleDateString('pt-BR')}</td>
                                            <td>${s.horaInicio} - ${s.horaFim}</td>
                                            <td>${s.quantidadePessoas}</td>
                                            <td><span class="badge badge-${s.status}">${s.status}</span></td>
                                            <td>
                                                <div style="display: flex; gap: 8px;">
                                                    ${s.status === 'pendente' ? `
                                                        <button onclick="aprovarSolicitacao(${s.id})" class="btn-aprovar" style="padding: 6px 12px;">
                                                            <i class="fas fa-check"></i> Aprovar
                                                        </button>
                                                        <button onclick="reprovarSolicitacao(${s.id})" class="btn-reprovar" style="padding: 6px 12px;">
                                                            <i class="fas fa-times"></i> Reprovar
                                                        </button>
                                                    ` : ''}
                                                    ${s.status === 'aprovado' ? `
                                                        <button onclick="abrirModalCancelamento(${s.id})" class="btn-cancelar">
                                                            <i class="fas fa-ban"></i> Cancelar
                                                        </button>
                                                    ` : ''}
                                                </div>
                                            </td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }
            
            else if (view === 'admin-espacos') {
                main.innerHTML = `
                    <div class="top-bar">
                        <h1 class="page-title"><i class="fas fa-door-open"></i> Espa√ßos</h1>
                        <button onclick="abrirModalNovoEspaco()" style="padding: 14px 28px; background: #3b82f6; color: white; border: none; border-radius: 40px; font-weight: 600; cursor: pointer;">
                            <i class="fas fa-plus"></i> Novo espa√ßo
                        </button>
                    </div>
                    
                    <div style="display: grid; gap: 20px;">
                        ${espacos.map(e => `
                            <div style="background: white; border-radius: 24px; padding: 24px; display: flex; justify-content: space-between; align-items: center;">
                                <div style="display: flex; gap: 20px; align-items: center;">
                                    <div style="background: ${e.cor}15; padding: 16px; border-radius: 18px;">
                                        <i class="fas ${e.icone}" style="color: ${e.cor}; font-size: 1.6rem;"></i>
                                    </div>
                                    <div>
                                        <h3 style="font-weight: 700; margin-bottom: 6px;">${e.nome}</h3>
                                        <div style="display: flex; gap: 16px; color: #475569;">
                                            <span><i class="fas fa-users"></i> ${e.capacidade}</span>
                                            <span><i class="fas fa-tag"></i> ${e.tipo}</span>
                                            <span class="badge badge-${e.status}">${e.status}</span>
                                        </div>
                                        <div style="margin-top: 8px; display: flex; flex-wrap: wrap; gap: 8px;">
                                            ${e.recursos.map(r => `<span style="background: #f1f5f9; padding: 4px 10px; border-radius: 40px; font-size: 0.8rem;">${r}</span>`).join('')}
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <button onclick="toggleEspacoStatus(${e.id})" style="padding: 10px 20px; background: ${e.status === 'ativo' ? '#fee2e2' : '#e0f2e6'}; color: ${e.status === 'ativo' ? '#b91c1c' : '#0b6e4f'}; border: none; border-radius: 40px; font-weight: 600; cursor: pointer;">
                                        <i class="fas fa-${e.status === 'ativo' ? 'ban' : 'check'}"></i> ${e.status === 'ativo' ? 'Desativar' : 'Ativar'}
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            else if (view === 'admin-usuarios') {
                main.innerHTML = `
                    <div class="top-bar">
                        <h1 class="page-title"><i class="fas fa-users-cog"></i> Usu√°rios</h1>
                        <span style="background: white; padding: 10px 20px; border-radius: 40px; font-weight: 500;">
                            Total: ${usuarios.length}
                        </span>
                    </div>
                    
                    <div style="background: white; border-radius: 24px; padding: 24px; overflow-x: auto;">
                        <table class="table-modern">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nome</th>
                                    <th>Email</th>
                                    <th>Tipo</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${usuarios.map(u => `
                                    <tr>
                                        <td>${u.id}</td>
                                        <td><strong>${u.nome}</strong></td>
                                        <td>${u.email}</td>
                                        <td><span class="badge badge-${u.tipo === 'admin' ? 'aprovado' : 'pendente'}">${u.tipo}</span></td>
                                        <td><span class="badge badge-${u.status}">${u.status}</span></td>
                                        <td>
                                            ${u.id !== currentUser.id ? `
                                                <button onclick="toggleUsuarioStatus(${u.id})" style="padding: 8px 16px; background: ${u.status === 'ativo' ? '#fee2e2' : '#e0f2e6'}; color: ${u.status === 'ativo' ? '#b91c1c' : '#0b6e4f'}; border: none; border-radius: 40px; font-weight: 600; cursor: pointer;">
                                                    <i class="fas fa-${u.status === 'ativo' ? 'ban' : 'check'}"></i> ${u.status === 'ativo' ? 'Desativar' : 'Ativar'}
                                                </button>
                                            ` : ''}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }
        }

        // ---------- FUN√á√ïES DE AUTENTICA√á√ÉO ----------
        window.fazerLogin = function() {
            const email = document.getElementById('loginEmail')?.value;
            const senha = document.getElementById('loginSenha')?.value;
            
            const usuario = usuarios.find(u => u.email === email && u.senha === senha && u.status === 'ativo');
            
            if (usuario) {
                currentUser = usuario;
                salvarSessao();
                renderizarInterface();
            } else {
                alert('Email ou senha inv√°lidos!');
            }
        };

        window.cadastrarUsuario = function() {
            const nome = document.getElementById('regNome')?.value;
            const email = document.getElementById('regEmail')?.value;
            const senha = document.getElementById('regSenha')?.value;
            const confirm = document.getElementById('regConfirmSenha')?.value;
            const tipo = document.getElementById('regTipo')?.value;
            const adminCode = document.getElementById('adminCode')?.value;
            
            if (!nome || !email || !senha) {
                alert('Preencha todos os campos!');
                return;
            }
            
            if (senha !== confirm) {
                alert('Senhas n√£o coincidem!');
                return;
            }
            
            if (tipo === 'admin' && adminCode !== 'ADMIN123') {
                alert('C√≥digo de administrador inv√°lido!');
                return;
            }
            
            if (usuarios.find(u => u.email === email)) {
                alert('Email j√° cadastrado!');
                return;
            }
            
            const novoUsuario = {
                id: usuarios.length + 1,
                nome: nome,
                email: email,
                senha: senha,
                tipo: tipo,
                status: 'ativo',
                avatar: nome.charAt(0).toUpperCase(),
                dataCadastro: new Date().toISOString()
            };
            
            usuarios.push(novoUsuario);
            salvarUsuarios();
            
            alert('Cadastro realizado com sucesso! Fa√ßa login.');
            document.getElementById('tabLoginBtn')?.click();
        };

        window.logout = function() {
            currentUser = null;
            localStorage.removeItem('spaceflow_user');
            renderizarInterface();
        };

        // ---------- FUN√á√ïES DE RESERVA ----------
        window.abrirModalReserva = function(espacoId) {
            if (!currentUser) {
                alert('Fa√ßa login primeiro!');
                return;
            }
            
            const espaco = espacos.find(e => e.id === espacoId);
            if (!espaco) return;
            
            espacoSelecionadoId = espacoId;
            
            document.getElementById('modalEspacoNome').innerHTML = `<i class="fas ${espaco.icone}" style="color: ${espaco.cor};"></i> ${espaco.nome}`;
            
            const amanha = new Date();
            amanha.setDate(amanha.getDate() + 1);
            document.getElementById('reservaData').min = amanha.toISOString().split('T')[0];
            document.getElementById('reservaData').value = amanha.toISOString().split('T')[0];
            
            carregarHorarios(espacoId);
            document.getElementById('modalReserva').classList.add('active');
        };

        window.fecharModalReserva = function() {
            document.getElementById('modalReserva').classList.remove('active');
            espacoSelecionadoId = null;
        };

        function carregarHorarios(espacoId) {
            const selectInicio = document.getElementById('reservaHoraInicio');
            const selectFim = document.getElementById('reservaHoraFim');
            
            selectInicio.innerHTML = '<option value="">Selecione</option>';
            selectFim.innerHTML = '<option value="">Selecione</option>';
            
            const horarios = [];
            for (let i = 8; i <= 21; i++) {
                horarios.push(`${i.toString().padStart(2,'0')}:00`);
                horarios.push(`${i.toString().padStart(2,'0')}:30`);
            }
            
            horarios.forEach(h => {
                const option = document.createElement('option');
                option.value = h;
                option.textContent = h;
                selectInicio.appendChild(option.cloneNode(true));
            });
            
            selectInicio.onchange = function() {
                const inicio = this.value;
                selectFim.innerHTML = '<option value="">Selecione</option>';
                
                if (!inicio) return;
                
                const [h, m] = inicio.split(':').map(Number);
                let minutos = h * 60 + m;
                
                for (let i = 1; i <= 8; i++) {
                    minutos += 30;
                    const horaFim = `${Math.floor(minutos/60).toString().padStart(2,'0')}:${(minutos%60).toString().padStart(2,'0')}`;
                    if (parseInt(horaFim.split(':')[0]) >= 22) break;
                    
                    const option = document.createElement('option');
                    option.value = horaFim;
                    option.textContent = horaFim;
                    selectFim.appendChild(option);
                }
            };
        }

        window.enviarSolicitacao = function() {
            if (!espacoSelecionadoId || !currentUser) return;
            
            const data = document.getElementById('reservaData').value;
            const horaInicio = document.getElementById('reservaHoraInicio').value;
            const horaFim = document.getElementById('reservaHoraFim').value;
            const pessoas = document.getElementById('reservaPessoas').value;
            const finalidade = document.getElementById('reservaFinalidade').value;
            
            if (!data || !horaInicio || !horaFim) {
                alert('Preencha todos os campos!');
                return;
            }
            
            const espaco = espacos.find(e => e.id === espacoSelecionadoId);
            
            const conflito = solicitacoes.find(s => 
                s.espacoId === espacoSelecionadoId &&
                s.data === data &&
                (s.status === 'aprovado' || s.status === 'pendente') &&
                (
                    (horaInicio >= s.horaInicio && horaInicio < s.horaFim) ||
                    (horaFim > s.horaInicio && horaFim <= s.horaFim)
                )
            );
            
            if (conflito) {
                alert('Este hor√°rio j√° est√° ocupado!');
                return;
            }
            
            const novaSolicitacao = {
                id: Date.now(),
                espacoId: espaco.id,
                espacoNome: espaco.nome,
                usuarioId: currentUser.id,
                usuarioNome: currentUser.nome,
                usuarioEmail: currentUser.email,
                data: data,
                horaInicio: horaInicio,
                horaFim: horaFim,
                quantidadePessoas: parseInt(pessoas),
                finalidade: finalidade,
                status: 'pendente',
                dataSolicitacao: new Date().toISOString(),
                motivoCancelamento: null
            };
            
            solicitacoes.push(novaSolicitacao);
            salvarSolicitacoes();
            
            // GERAR LINK COMPARTILH√ÅVEL AUTOMATICAMENTE
            const link = gerarLinkCompartilhavel();
            
            // Mostrar modal com link
            document.getElementById('linkCompartilhavelTexto').textContent = link;
            document.getElementById('modalLink').classList.add('active');
            
            // Notificar admins
            const admins = usuarios.filter(u => u.tipo === 'admin' && u.status === 'ativo');
            admins.forEach(admin => {
                enviarEmail(admin.email, 'üìå Nova solicita√ß√£o de reserva', 
                    `Usu√°rio ${currentUser.nome} solicitou ${espaco.nome} para ${new Date(data).toLocaleDateString('pt-BR')} √†s ${horaInicio}.\n\nCOMPARTILHE O LINK: ${link}`);
            });
            
            fecharModalReserva();
            renderizarView('user-solicitacoes');
        };

        // ---------- FUN√á√ïES DE CANCELAMENTO ----------
        window.abrirModalCancelamento = function(solicitacaoId) {
            const solicitacao = solicitacoes.find(s => s.id === solicitacaoId);
            if (!solicitacao) return;
            
            solicitacaoParaCancelar = solicitacaoId;
            
            const modal = document.getElementById('modalCancelamento');
            const info = document.getElementById('cancelamentoInfo');
            
            info.innerHTML = `
                <strong style="font-size: 1.1rem;">${solicitacao.espacoNome}</strong><br>
                Data: ${new Date(solicitacao.data).toLocaleDateString('pt-BR')} ‚Ä¢ ${solicitacao.horaInicio} √†s ${solicitacao.horaFim}<br>
                Solicitante: ${solicitacao.usuarioNome}
            `;
            
            modal.classList.add('active');
        };

        window.fecharModalCancelamento = function() {
            document.getElementById('modalCancelamento').classList.remove('active');
            document.getElementById('motivoCancelamento').value = '';
            solicitacaoParaCancelar = null;
        };

        window.confirmarCancelamento = function() {
            if (!solicitacaoParaCancelar) return;
            
            const motivo = document.getElementById('motivoCancelamento').value.trim() || 'N√£o informado';
            const index = solicitacoes.findIndex(s => s.id === solicitacaoParaCancelar);
            
            if (index !== -1) {
                solicitacoes[index].status = 'cancelado';
                solicitacoes[index].motivoCancelamento = motivo;
                solicitacoes[index].dataCancelamento = new Date().toISOString();
                solicitacoes[index].canceladoPor = currentUser.nome;
                salvarSolicitacoes();
                
                const solicitacao = solicitacoes[index];
                
                // Gerar link atualizado
                const link = gerarLinkCompartilhavel();
                
                // Email para o usu√°rio
                enviarEmail(solicitacao.usuarioEmail, '‚ùå Reserva cancelada', 
                    `Sua reserva do ${solicitacao.espacoNome} para ${new Date(solicitacao.data).toLocaleDateString('pt-BR')} √†s ${solicitacao.horaInicio} foi CANCELADA.\nMotivo: ${motivo}\nCancelado por: ${currentUser.nome}\n\nLINK ATUALIZADO: ${link}`);
                
                alert('Reserva cancelada com sucesso!');
                fecharModalCancelamento();
                
                if (currentUser.tipo === 'admin') {
                    renderizarView('admin-solicitacoes');
                } else {
                    renderizarView('user-solicitacoes');
                }
            }
        };

        // ---------- FUN√á√ïES DE ADMIN ----------
        window.aprovarSolicitacao = function(solicitacaoId) {
            const solicitacao = solicitacoes.find(s => s.id === solicitacaoId);
            if (!solicitacao) return;
            
            solicitacao.status = 'aprovado';
            salvarSolicitacoes();
            
            // Gerar link atualizado
            const link = gerarLinkCompartilhavel();
            
            enviarEmail(solicitacao.usuarioEmail, '‚úÖ Reserva aprovada!', 
                `Sua reserva do ${solicitacao.espacoNome} para ${new Date(solicitacao.data).toLocaleDateString('pt-BR')} √†s ${solicitacao.horaInicio} foi APROVADA.\n\nLINK ATUALIZADO: ${link}`);
            
            alert('Solicita√ß√£o aprovada!');
            renderizarView('admin-solicitacoes');
        };

        window.reprovarSolicitacao = function(solicitacaoId) {
            const solicitacao = solicitacoes.find(s => s.id === solicitacaoId);
            if (!solicitacao) return;
            
            const motivo = prompt('Motivo da reprova√ß√£o (opcional):');
            
            solicitacao.status = 'reprovado';
            solicitacao.observacao = motivo || 'N√£o informado';
            salvarSolicitacoes();
            
            // Gerar link atualizado
            const link = gerarLinkCompartilhavel();
            
            enviarEmail(solicitacao.usuarioEmail, '‚ùå Reserva reprovada', 
                `Sua reserva do ${solicitacao.espacoNome} para ${new Date(solicitacao.data).toLocaleDateString('pt-BR')} √†s ${solicitacao.horaInicio} foi REPROVADA.\nMotivo: ${motivo || 'N√£o informado'}\n\nLINK ATUALIZADO: ${link}`);
            
            alert('Solicita√ß√£o reprovada!');
            renderizarView('admin-solicitacoes');
        };

        window.toggleEspacoStatus = function(espacoId) {
            const espaco = espacos.find(e => e.id === espacoId);
            if (espaco) {
                espaco.status = espaco.status === 'ativo' ? 'inativo' : 'ativo';
                salvarEspacos();
                renderizarView('admin-espacos');
            }
        };

        window.toggleUsuarioStatus = function(usuarioId) {
            const usuario = usuarios.find(u => u.id === usuarioId);
            if (usuario) {
                usuario.status = usuario.status === 'ativo' ? 'inativo' : 'ativo';
                salvarUsuarios();
                renderizarView('admin-usuarios');
            }
        };

        window.abrirModalNovoEspaco = function() {
            const nome = prompt('Nome do novo espa√ßo:');
            if (!nome) return;
            
            const tipo = prompt('Tipo (sala/auditorio/treinamento/lazer/especial/esportes):', 'esportes');
            if (!tipo) return;
            
            const capacidade = parseInt(prompt('Capacidade m√°xima:', '20'));
            if (!capacidade) return;
            
            const recursos = prompt('Recursos (separados por v√≠rgula):', 'Grama Sint√©tica, Ilumina√ß√£o, Vesti√°rios').split(',').map(r => r.trim());
            
            const iconeMap = {
                'sala': 'fa-video',
                'auditorio': 'fa-chalkboard',
                'treinamento': 'fa-lightbulb',
                'lazer': 'fa-couch',
                'especial': 'fa-microphone',
                'esportes': 'fa-futbol'
            };
            
            const corMap = {
                'sala': '#2563eb',
                'auditorio': '#8b5cf6',
                'treinamento': '#eab308',
                'lazer': '#10b981',
                'especial': '#ec4899',
                'esportes': '#22c55e'
            };
            
            const novoEspaco = {
                id: espacos.length + 1,
                nome: nome,
                tipo: tipo,
                capacidade: capacidade,
                recursos: recursos,
                descricao: 'Novo espa√ßo cadastrado',
                imagem: 'https://images.unsplash.com/photo-1497366216548-37526070297c?w=600',
                icone: iconeMap[tipo] || 'fa-door-open',
                status: 'ativo',
                cor: corMap[tipo] || '#3b82f6'
            };
            
            espacos.push(novoEspaco);
            salvarEspacos();
            renderizarView('admin-espacos');
        };

        // ---------- INICIALIZA√á√ÉO ----------
        window.addEventListener('load', function() {
            // Tentar carregar dados do link primeiro
            if (carregarDadosDoLink()) {
                mostrarNotificacao('üì¶ Dados sincronizados via link!', 'success');
            }
            
            salvarUsuarios();
            salvarEspacos();
            salvarSolicitacoes();
            renderizarInterface();
        });
    </script>
</body>
</html>
